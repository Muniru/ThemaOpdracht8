---
title: "Eindopdracht"
author: "Muniru & Sam"
date: '2022-06-03'
output:
  pdf_document:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(deSolve)

parameters <- c(m = 0.445, r = 0.11,
                rho = 1.29, c = 0.5,
                mu = 0.1, g = 9.81)

state_straight <- c(omega = c(x = 0, y = 0, z = 0),
                    velocity = c(x = 5, y = 28, z = 11),

state_curve <- c(omega = c(x = 2, y = -2, z = 16),
                 velocity = c(x = 5, y = 28, z = 11),

state_up <- c(omega = c(x = 13, y = 0, z = 0),
              velocity = c(x = 5, y = 28, z = 11),

times <- seq(0, 100, by = 1)

model <- function(t, y, parms){
  with(as.list(c(y, parms)), {
    position <- c(x = 7.23, y = 0, z = 0)
    omega <- c(omega.x, omega.y, omega.z)
    velocity <- c(velocity.x, velocity.y, velocity.z)
    F_magnus <- (8/3) * pi * rho * r^3 * crossprod(omega, velocity)
    F_air <- c * velocity.y^2
    F_mg <- m * g
    
    return(list(c(F_magnus, F_air, F_mg)))
  }
  )
}

out <- as.data.frame(ode(times = times, y = state_up, parms = parameters, func = model, method = "euler"))

```